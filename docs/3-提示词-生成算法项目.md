### 项目名称：MLDLAlgorithmCode

---

## 环境配置提示词（贯穿所有 Phase）

```text
【环境配置统一要求】
本项目 MLDLAlgorithmCode 所有子项目共享统一虚拟环境，你在生成任何子项目时必须遵守以下规则：

1. 虚拟环境规范
   - 环境名称：mldl_algo311
   - Python 版本：3.11
   - 管理工具：conda
   - 激活命令：conda activate mldl_algo311

2. 依赖管理规范
   - 每个子项目必须有独立的 requirements.txt
   - 使用 >= 指定最低版本（禁止使用 == 固定版本，除非有特殊原因）
   - 所有依赖安装到共享虚拟环境 mldl_algo311 中
   - 安装命令：pip install -r requirements.txt

3. 文档要求（Phase 4 生成时必须包含）
   - README.md：必须包含"环境配置"章节，说明如何激活环境和安装依赖
   - QUICK_START.md：必须在运行步骤前加入环境激活步骤

4. 运行命令格式（Phase 4/5 交付时必须遵守）
   所有运行命令必须以环境激活开头：
   
   # Step 1: 激活虚拟环境（必须）
   conda activate mldl_algo311
   
   # Step 2: 进入子项目目录
   cd MLDLAlgorithmCode/{folder_name}
   
   # Step 3: 安装依赖（首次使用）
   pip install -r requirements.txt
   
   # Step 4: 运行项目
   python main.py

5. 验收清单（Phase 5 必须检查）
   - README.md 包含环境配置章节
   - QUICK_START.md 包含环境激活步骤
   - requirements.txt 使用 >= 版本规范
   - 最终交付命令以环境激活开头

【重要】：以上规则贯穿 Phase 1-5，不得遗漏或简化。
```

---

## Phase 0 提示词（启动 + 计划表 + 询问算法名）

```text
你将作为“算法案例项目生成器”工作。无论你是否具备 plan/计划模式，都必须严格遵守以下总流程，并在每个阶段结束后停下等待我的确认，未得到确认不得进入下一阶段。

【总流程（不可更改）】
Phase 0：启动与输入收集（本阶段只做：确认流程/输出计划/询问算法名/自判ML或DL）
Phase 1：创建子项目文件夹（只创建边界目录，不创建内部结构；并把计划写入 PLAN.md）
Phase 2：算法规格书（只写算法与经典案例的详细规格文档 ALGO_SPEC.md，不写代码）
Phase 3：代码设计文档（只写目录结构与文件职责与入口，不写最终代码；输出 IMPLEMENTATION_DESIGN.md）
Phase 4：生成代码（严格按设计文档逐文件生成）
Phase 5：验证与修复（按验收清单自检，补缺项，给出可运行命令与预期输出）

【计划模式兼容规则】
- 如果你具备内置的 plan/任务分解能力：可以先用它生成计划，但必须在此基础上“增补优化”，让计划完全覆盖并对齐 Phase 0-5。
- 如果你不具备：也必须输出等价的计划。
- 计划允许比 Phase 更细（可拆子步骤），但不得跳过任何 Phase，不得提前写代码。
- 计划必须包含每个 Phase 的：目标、主要动作、产出物、验证方式、需要我确认的节点。
- 计划先在对话中输出；并在 Phase 1 创建子项目文件夹后，将同一份计划写入子文件夹内的 PLAN.md。

【分类规则（重要）】
- 你不得询问我“这是机器学习还是深度学习”。
- 你必须根据算法名称自行判断属于 ML 或 DL（必要时可检索/查资料），并给出一句简短理由。
- 该判断用于后续 Phase 1 的子文件夹命名（ml_ 或 dl_）。

【本阶段（Phase 0）允许做的事】
- 复述你将严格按 Phase 0-5 执行，并且每阶段结束停下等待确认。
- 输出计划表（Plan Table，表格或清单都可）。
- 询问我：要生成的算法名称是什么？
- 在我给出算法名后：你需要立刻完成“ML/DL 分类判断 + 算法名规范化为 snake_case + 预告将创建的文件夹名（ml_xxx 或 dl_xxx）”，然后停下，等待我确认进入 Phase 1。

【本阶段（Phase 0）禁止做的事】
- 禁止创建任何文件夹/文件（计划文件要到 Phase 1 才能写入）
- 禁止写任何代码
- 禁止输出 ALGO_SPEC.md 或 IMPLEMENTATION_DESIGN.md 的内容

现在请执行 Phase 0：
1) 先输出计划表（Plan Table）
2) 然后问我：算法名称是什么？
```

---

## Phase 1 提示词（创建子文件夹 + 写 PLAN.md）

```text
现在进入 Phase 1：创建子项目文件夹（只创建边界目录）并写入说明文件 PLAN.md。

【本阶段目标】
- 在总仓库 MLDLAlgorithmCode/ 下创建该算法的子文件夹（命名：ml_ 或 dl_ + snake_case）。
- 在该子文件夹内新建 PLAN.md，用于记录本算法子项目的流程计划与基础信息（可追溯）。
- 本阶段结束后必须停下，等待我确认是否进入 Phase 2（生成 ALGO_SPEC.md）。

【必须遵守】
1) 只创建“子项目边界目录”，不要创建任何内部项目结构（不要建 src/、scripts/、requirements.txt 等）。
2) 不要生成 ALGO_SPEC.md，不要生成 IMPLEMENTATION_DESIGN.md，不要写任何代码。
3) 从现在开始，所有后续输出（文档/代码/结果）都必须位于该子文件夹中。

【执行步骤】
Step 1) 创建目录：
- 路径：MLDLAlgorithmCode/{folder_name}/
- 其中 {folder_name} = ml_{algo_slug} 或 dl_{algo_slug}（你在 Phase 0 已给出）

Step 2) 创建文档目录：
- 路径：MLDLAlgorithmCode/{folder_name}/docs/
- 用于存放所有过程文档（PLAN.md, ALGO_SPEC.md, IMPLEMENTATION_DESIGN.md, QUICK_START.md）

Step 3) 在文档目录下新建文件：MLDLAlgorithmCode/{folder_name}/docs/PLAN.md
- PLAN.md 必须包含以下信息（可以更丰富，但不得遗漏）：
  - 算法名称（原始输入 + 规范化名称 algo_slug）
  - 分类（ML 或 DL）以及一句简短理由
  - 创建日期（ISO格式：YYYY-MM-DD）
  - 计划表（Plan Table）：即你在 Phase 0 输出的那份完整计划（原样写入）
  - 下一阶段提示：Phase 2 将生成 ALGO_SPEC.md（需我确认后才开始）

【已存在目录处理】
- 如果 MLDLAlgorithmCode/{folder_name}/ 已存在：
  - 不要删除或覆盖原有内容；
  - 确保 docs/ 文件夹存在，若不存在则创建
  - 仍然要确保 docs/PLAN.md 存在：
    - 若 docs/PLAN.md 不存在：新建
    - 若 docs/PLAN.md 已存在：新建 docs/PLAN_update_YYYY-MM-DD.md（或在原文件末尾追加一段 Update 也可以）
  - 在对话中说明你采取了哪种方式。

【完成后停下】
- 完成本阶段后，你必须：
  1) 简短确认已创建的路径与新增的文件名（包括 docs/ 文件夹和 docs/PLAN.md）
  2) 询问我：是否进入 Phase 2 生成 ALGO_SPEC.md
```

---

## Phase 2 提示词（生成 ALGO_SPEC.md：重点加入“默认生成数据”）

```text
现在进入 Phase 2：生成算法规格书（ALGO_SPEC.md）。

【本阶段目标】
- 你必须基于已确定的算法名称，对该算法做“严谨的需求/案例分析”，并在子项目文件夹内生成一份算法规格书：ALGO_SPEC.md。
- 这份规格书用于后续实现（Phase 3/4），因此必须“可执行、可验收、可追溯”。
- 本阶段只写规格书，不写任何代码，不创建项目内部结构（src/等）。

【重要原则】
- 不同算法的结论不同：你不能套固定结论。
- 但分析框架必须固定：你必须按下面的模块逐项分析并填充内容。
- 你不得仅演示“跑通算法/调用库”；必须围绕“经典案例 + 算法核心价值”来设计规格。
- 数据安全性/保密性/真实性对本项目不重要：默认优先使用“自动生成的合成数据(synthetic)”来完成演示与实验；如确实不适合合成（例如需要文本/图像形态），可改用可自动获取的公开/内置小数据集，但仍不要求用户提供真实敏感数据。


【特殊场景处理规则】
如果算法属于以下特殊类型，必须在 ALGO_SPEC.md 中增加对应的特殊说明章节（在第 8 章"结构化规格块"之前插入）：

A) 强化学习算法（Q-Learning, DQN, PPO, A3C 等）
   - 增加章节：# 9. 环境定义（Environment Specification）
   - 必须说明：环境类型（gym/自定义）、状态空间、动作空间、奖励函数、终止条件
   - 实验设计必须包含：策略学习曲线、策略可视化
   - 输出物增加：训练好的策略模型、策略演示视频/动图

B) 生成模型（GAN, VAE, Diffusion, Flow 等）
   - 增加章节：# 9. 生成样本规范（Generation Specification）
   - 必须说明：生成目标（图像/文本/音频）、生成质量评估指标（FID/IS/BLEU等）
   - 实验设计必须包含：生成样本展示、质量演化曲线
   - 输出物增加：生成样本集合（至少10个）、质量对比图

C) 大规模预训练模型（BERT, GPT, ResNet fine-tuning 等）
   - 增加章节：# 9. 预训练模型策略（Pretrained Model Strategy）
   - 必须说明：使用的预训练模型名称、来源、加载方式、fine-tuning 策略
   - complexity_level 建议设为 Standard 或 Project
   - 实验设计聚焦于 fine-tuning 效果，不要求从零训练

D) 时序预测算法（ARIMA, Prophet, LSTM时序 等）
   - 增加章节：# 9. 时序数据规范（Time Series Specification）
   - 必须说明：时间粒度、序列长度、趋势/季节性/噪声设计
   - synthetic 数据必须包含明确的时序特性（趋势/周期）
   - 实验设计必须包含：预测窗口敏感性、滚动预测验证

E) 图神经网络（GCN, GAT, GraphSAGE 等）
   - 增加章节：# 9. 图数据规范（Graph Data Specification）
   - 必须说明：图类型（社交网络/分子/知识图谱）、节点特征、边特征
   - synthetic 数据必须能生成有意义的图结构
   - 实验设计必须包含：图结构可视化、节点/边的预测任务

【重要】：
- 如果算法不属于上述特殊类型，不要增加第 9 章，保持原有 8 章结构。
- 特殊场景的处理不改变基本框架（8 章必须内容仍然要写），只是增补特殊要求。
- 在 ALGO_SPEC.md 开头的"基本信息"中增加一行：特殊场景类型（如适用）：A/B/C/D/E/无

【必须写入文件】
- 在目录：MLDLAlgorithmCode/{folder_name}/docs/ 下创建并写入：ALGO_SPEC.md

【ALGO_SPEC.md 内容结构（必须包含）】

# 1. 基本信息
- 算法名称（原始输入）
- 规范化名称（snake_case）
- 分类（ML 或 DL）+ 一句理由
- 本规格书日期（YYYY-MM-DD）

# 2. 算法定位（What / When）
- 任务类型
- 最典型应用场景（1个）
- 适用条件（<=3）
- 局限（<=3）

# 3. 数据契约（Data Contract，必须具体）
- 输入数据形态：tabular/image/text/time_series/other
- 是否监督学习：是否需要 label？如何提供？
- 默认数据策略（强制）：
  - 默认使用 synthetic（合成数据）并能覆盖实验需求
  - 若必须用公开数据：选择可自动加载/自动下载的小数据集
- 用户数据接口（仍需支持，但不是必须提供）：
  - CSV：data/input.csv
  - Excel：data/input.xlsx（默认第一个sheet）
  - 监督学习默认目标列名：target 或 label；若不存在需 target_col 参数
- 必要预处理与原因（标准化/缺失值/分词等）

# 4. 核心价值点与标志性特性（Signature Value）
- 核心价值点（<=3）
- 必须通过代码“看得见”的特性点（2~3条）

# 5. 实验设计（>=3，且覆盖三类）
每个实验写清：目的/变量/指标/可视化输出/预期现象
必须至少覆盖：
A) 特性实验（超参/敏感性/关键现象）
B) 对照实验（baseline 或 reference）
C) 可视化/解释输出（让行为可见）

# 6. 输出物与验收标准（DoD）
- 至少 1 指标 + 1 图 + 1 对照
- experiments（>=3）全部实现
- 特性点在结果中可见
- 默认数据可跑通（synthetic 优先）+ 支持用户数据
- 最小可运行路径（低资源也能跑）

# 7. 复杂度等级与实现建议
- complexity_level：Minimal / Standard / Project
- 理由
- 最小实现边界（Minimal也必须闭环）

# 8. 结构化规格块（YAML，必须）
字段至少包含：
- algo
- category (ml/dl)
- task_type
- input_type
- complexity_level
- default_data_mode: synthetic
- user_data_supported: true
- target_col_default（如适用）
- experiments: [...]
- metrics: [...]
- figures: [...]
- outputs_dir: outputs/

【禁止事项】
- 禁止写任何代码
- 禁止创建 src/、scripts/ 等内部结构
- 禁止空泛描述（必须可执行：数据契约/实验/DoD）

【结束关卡】
- 写入 ALGO_SPEC.md 后，在对话输出“规格书摘要”（经典案例/特性点/实验清单/complexity_level）
- 然后询问我：是否通过并进入 Phase 3（IMPLEMENTATION_DESIGN.md）
```

---

## Phase 3 提示词（生成 IMPLEMENTATION_DESIGN.md）

```text
现在进入 Phase 3：生成实现设计文档（IMPLEMENTATION_DESIGN.md）。

【本阶段目标】
- 严格以 ALGO_SPEC.md 为唯一真实来源（source of truth）。
- 将其转换为“可施工”的工程实现设计：目录树、文件职责、CLI、输出规范、验证计划。
- 本阶段只写设计文档，不写最终代码，不创建实际内部结构文件。
【重要】：
- 如果算法不属于上述特殊类型，不要增加第 9 章，保持原有 8 章结构。
- 特殊场景的处理不改变基本框架（8 章必须内容仍然要写），只是增补特殊要求。
- 在 ALGO_SPEC.md 开头的"基本信息"中增加一行：特殊场景类型（如适用）：A/B/C/D/E/无

【必须写入文件】
- MLDLAlgorithmCode/{folder_name}/docs/IMPLEMENTATION_DESIGN.md

【输入约束】
- 必须读取并引用 docs/ALGO_SPEC.md（complexity_level/experiments/metrics/figures/data contract/DoD/特殊场景类型）
- 如果 ALGO_SPEC.md 标注了特殊场景类型（A/B/C/D/E），必须在设计中体现对应的特殊要求
- 如发现矛盾，只能列问题与建议，不得擅自改规格；暂停等待我确认。

【规模自适应】
- Minimal：允许单/少文件，但必须完整闭环并满足DoD
- Standard/Project：设计项目结构（src/scripts/outputs/data/tests等）

【文档必须包含】
1) 与 ALGO_SPEC 对齐摘要（逐条覆盖DoD）
2) 项目落地形式选择（为什么）
3) 目录结构草案（Project Tree Draft）
4) 文件职责（数据/核心算法/实验入口/评估/可视化/工具）
5) CLI设计（默认可跑synthetic；可选data_path/target_col/experiment/seed）
6) 输出物规范（metrics/figures路径与命名）
7) 依赖原则（必要时torch，但提供最小CPU可跑策略）
8) 验证计划（冒烟测试 + DoD清单）
9) 环境配置说明（虚拟环境 mldl_algo311 + requirements.txt 规范）

【禁止事项】
- 禁止输出最终实现代码
- 禁止实际创建内部结构（只设计）

【结束关卡】
- 写入后输出“设计摘要”（目录要点/入口命令/输出产物/验证清单要点）
- 询问我是否进入 Phase 4（生成代码）
```

---

## Phase 4 提示词（按设计生成代码：强调默认 synthetic）

```text
现在进入 Phase 4：生成代码（Implementation）。

【本阶段目标】
- 以 IMPLEMENTATION_DESIGN.md 为施工蓝图，以 ALGO_SPEC.md 为验收标准（DoD）。
- 在 MLDLAlgorithmCode/{folder_name}/ 内生成所有需要的文件与代码，形成端到端闭环。
- 默认必须可运行：优先使用 synthetic（合成数据）自动生成数据完成演示与实验；不要求用户提供真实数据。

【输入约束】
- 必须遵循 docs/ALGO_SPEC.md（experiments/metrics/figures/data contract/DoD/default_data_mode=synthetic/特殊场景类型）
- 必须遵循 docs/IMPLEMENTATION_DESIGN.md（目录/文件职责/CLI/输出规范）
- 如果 ALGO_SPEC.md 标注了特殊场景类型（A/B/C/D/E），必须实现对应的特殊输出物和实验
- 冲突时以 ALGO_SPEC.md 为准并说明。

【必须实现（缺一不可）】
1) 默认数据可跑通：实现合成数据生成逻辑（synthetic）并作为默认路径
2) 用户数据支持：CSV/Excel + target_col（可选，但要支持）
3) experiments（>=3）可运行，并覆盖特性/对照/可视化
4) 至少 1 指标输出 + 至少 1 图输出到 outputs/figures/
5) 至少 1 对照（baseline/reference）并输出对比结果
6) CLI：不带参数可跑默认demo；带参数可跑用户数据
7) seed 固定，可复现；错误提示友好
8) requirements.txt：使用 >= 指定最低版本，避免 == 固定版本
9) README.md：必须包含虚拟环境激活步骤，放在子项目根目录
10) QUICK_START.md：必须包含虚拟环境激活步骤，放在 docs/ 文件夹
11) 代码注释规范：
    - 每个文件开头有文件头注释（中文）：文件名、主要功能
    - 每个类有类注释（中文）：说明类的作用
    - 每个函数有函数注释（中文）：功能、参数、返回值
    - 关键代码块有行内注释（中文）：解释复杂逻辑

【输出格式】
- 若可写文件：直接创建并写入
- 若不可写文件：先输出项目树，再逐文件输出完整内容，格式：
  --- FILE: MLDLAlgorithmCode/{folder_name}/<path/filename> ---
  <完整内容>

【禁止事项】
- 禁止只“调用库跑通”而不体现特性与实验
- 禁止遗漏关键输出（指标/图/对照）

【完成后停下】
- 输出运行命令清单（默认demo + 用户数据示例）
- 输出预期产物位置（metrics/figures）
- 询问我是否进入 Phase 5（验证与修复）
```

---

## Phase 5 提示词（验证与修复）

```text
现在进入 Phase 5：验证与修复（Verification & Fix）。

【本阶段目标】
- 对照 docs/ALGO_SPEC.md 的 DoD 逐条验收当前实现；缺项必须修复，直到全部通过。
- 最终交付：运行命令 + 产物位置清单 + 简短结果解读。

【验收清单（必须逐条打勾汇报）】
1) 默认数据可跑通（synthetic）
2) 用户数据可跑通（CSV/Excel + target_col，如适用）
3) 至少 1 指标输出（固定格式与位置）
4) 至少 1 图输出到 outputs/figures/
5) 至少 1 对照并可见对比
6) experiments（>=3）全部可运行
7) 特性点在结果中可见
8) 入口命令清晰（默认demo可跑）
9) 可复现（seed/元信息）
10) 友好报错
11) README.md 包含环境激活步骤（在子项目根目录）
12) QUICK_START.md 包含环境激活步骤（在 docs/ 文件夹）
13) requirements.txt 使用 >= 版本规范
14) 特殊场景要求（如 docs/ALGO_SPEC.md 标注了 A/B/C/D/E）：对应的特殊输出物和实验已实现
15) 代码注释完整：所有文件/类/函数有中文注释

【验证方式】
- 若能执行：实际运行默认demo命令并检查输出
- 若不能执行：静态验证并明确哪些点需要运行确认

【修复规则】
- 不得降低 DoD
- 修复后重新更新清单状态，直到全绿

【最终交付（必须输出）】
A) 环境激活命令：conda activate mldl_algo311
B) 依赖安装命令：pip install -r requirements.txt
C) 默认demo命令 + 用户CSV/Excel命令
D) 指标/图/模型等产物路径
E) 3-5句解读：展示了哪些特性点、对照说明什么价值/局限
F) 自动更新根项目状态（必须执行）：
   
   在根项目的 README.md（路径：MLDLAlgorithmCode/README.md）的"已完成的算法"表格中，
   自动添加一行新记录，包含：
   - 算法名称（中文全称）← 使用本次生成的算法名称
   - 子项目目录（格式：`ml_xxx/` 或 `dl_xxx/`）← 使用本次创建的子项目目录
   - 分类（ML 或 DL）← 使用本次算法的分类
   - 状态（✅ 完成）
   - 实验数量 ← 统计本次实现的实验数量
   - 简短说明（1句话，描述主要实验内容）← 总结本次实验的核心内容
   
   表格格式（每列用 | 分隔）：
   | 算法名称 | `目录/` | 分类 | ✅ 完成 | 数量 | 说明 |
   
   注意：
   - 必须找到"已完成的算法"表格（在"## 项目状态"章节下）
   - 在表格最后一行后面添加新行
   - 不要修改表格的其他内容
   - 添加完成后，确认并告知用户已更新根项目 README.md
```

